# JSCompiler

JavaScript interpreter and evaluator implemented with the help of [Jison](https://github.com/zaach/jison) and [Lex](https://github.com/aaditmshah/lexer). 

Aims to become a compiler-compiler by applying the three [Futamura projections](https://en.wikipedia.org/wiki/Partial_evaluation).

## Permitted language syntax
The language should be consistent with the JavaScript syntax rules, but contain a smaller subset of them
* Constant (integers, booleans and strings)
* Arrays (initialisation, indexing and length calculation)
* Local and global variable declarations (`const`, `let`, `var`, but they are all syntactic sugar for `var`)
* Variable assignment
* Arithmetic and logical operations (no `++` or `--`)
* If statements
* For loops
* Return statements
* Functions (including recursion, but not including inline function definitions)
* `console.log(...)`
* `throw new Error(...)`
* `Object.keys()`
* Switch statements (T0DO)
* Breaks (TODO)
* `module.export = { ... }` (TODO)

## What it does
The JSCompiler contains a lexer, parser, interpreter and partial evaluator. 
* The lexer tokenises and checks for incorrect syntax.
* The parser takes a string of code representing a program and produces an abstract syntax tree.
* The interpreter takes two strings, one representing a program and one representing a function call, and runs through the parse tree generated by the parser to evaluate the value returned by the provided function call.
* The partial evaluator takes the same arguments as the interpreter and returns a new parse tree where representing an optimised version of the initial parse tree of the program.

        It is a naive implementation of a partial evaluator, but performs the following optimisations:
         - constant folding
         - constant propagation
         - constant inlining
         - function inlinging
         - tail call optimisation
         - dead code elimination
         - loop unrolling

## How to run it
`node index.js -p <fileName.js>` - prints out a parse tree

`node index.js -i <fileName.js> "<function call>"` - returns result of interpreter

`node index.js -e <fileName.js> "<function call>"` - returns result of evaluator

`node index.js -ti` - tests the interpreter (with example function from `test.js`; used for regression testing)

`node index.js -te` - tests the evaluator (with example function from `test.js`; used for regression testing)